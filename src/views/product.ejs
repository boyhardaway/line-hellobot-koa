<h2>Calling the LIFF Product</h2>
<%console.log(products[0])%>
    <select id="mySelect" onchange="liff()">
        <%products.forEach(product => {%>
            <option value=<%- product.id %>>
                <%- product.name %>
            </option>
            <%})%>
    </select>

    <script>
        $(window).on('load', function () {
            // Initializes a LIFF app
            liff.init(function (data) {})
        })

        function liff() {
            console.log('liff')
            console.log(document.getElementById("mySelect").value)
            liff.getProfile().then((profile) => {
                liff.sendMessages([{
                        type: 'text',
                        text: 'productName:' + document.getElementById("mySelect").value
                    },
                    {
                        type: 'text',
                        text: 'From:' + profile.displayName
                    }
                ]).then(function () {
                    liff.closeWindow()
                }).catch(function (error) {
                    window.alert('Error sending message: ' + error.message)
                })
            }).catch(function (error) {
                window.alert("Error getting profile: " + error.message)
            })
        }
    </script>